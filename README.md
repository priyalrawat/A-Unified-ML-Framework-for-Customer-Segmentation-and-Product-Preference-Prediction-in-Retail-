# A-Unified-ML-Framework-for-Customer-Segmentation-and-Product-Preference-Prediction-in-Retail-
**Abstract**

This study offers a comprehensive machine learning method for customer segmentation and product purchase prediction, utilizing a real-world retail marketing dataset from Kaggle combining customer demographics, purchasing behavior, and marketing campaign responses. Various unsupervised learning models such as K-Means, Agglomerative Clustering, and DBSCAN were performed before and after various forms of dimensionality reduction using Principal Component Analysis (PCA). Following PCA K-Means performed better with K-Means achieving a silhouette score of 0.38, compared to 0.21 before PCA, and showed improved clustering separability relating to customer groups with ten targets identified that could be interpreted easily. DBSCAN didn’t work out after PCA. In the supervised modelling phase, five classification models were built to predict what the next product a customer would purchase. Of the models, XGBoost had the highest performance with an accuracy of 0.77 and F1 scores of 0.75 (after SMOTE). Hyperparameter tuning and SMOTE was applied but there was no significant improvement in the mode performance. The performance of the models was not at par and relevant for real world settings. Cluster labels and product prediction outputs were presented at the same time, giving customers insights into what products could be considered next, thus better personalizing their profile. The predictive improvements detailed in this study were limited, however, this study has demonstrated that retail businesses can substantially benefit by integrating unsupervised and supervised modelling outputs to influence, better inform, customer data-driven retail strategies. The performance of the models was not at par and relevant for real world settings. Future work includes integrating deep learning models. 


## Introduction
In today's data-driven retail environment, understanding customers' behavior is one of the most important and strategic requirements for businesses. Customer market has become more complex than ever before and personalized customer experience is now treated as a standard services, retailers have to go further and beyond to retain customers and provide best customer experience and for that understanding consumer purchasing behaviors is extremely important and plays a major role. This is the most promising area for growth is the ability to understand customer behavior predicting what a customer is most likely to buy. Some retailers and brands have traditionally relied on gut instinct or manual observations. However, machine learning models can analyze the large amount of customer data, their behavioral, demographic data produced since the first interaction and provide meaningful insights for the businesses.

Traditional segmentation models have guided marketing efforts for the longest period of time, but they usually rely on static attributes or rely or on outdated assumptions. This field has made considerable advances with the integration of behavioral segmentation (Ramkumar et al., 2025; Suh, 2025) with frameworks for predictive modeling of loyalty, churn, or customer value (Kabir et al., 2025; Bhatia & Gupta, 2025). Still, there are very few studies where the focus on unsupervised customer segmentation is linked to predicting customer product preferences that too from a structured dataset which has multiple product categories and marketing touch points that tracks spending behavior of a customer.

To bridge this gap, this study focuses on a unified machine learning approach that integrates unsupervised customer segmentation with supervised product preference prediction, based on a real-world retail dataset. The study starts by grouping customers together using clustering techniques such as K-Means, Hierarchical clustering and DBSCAN and these models have been evaluated using metrics such as Silhouette Score, WCSS, Davies-Bouldin Index and Calinski-Harabasz (Deldadehasl et al, 2025; Lathifah & Azzahra, 2025). Principal component analysis (PCA) has been applied to further improve the segmentation. The clusters formed from an unsupervised learning are then used as extra inputs for classification algorithms such as logistic regression, Knn, decision tree, random forest, XGboost to predict what customers is going to buy in their next purchase (Kabir et al, 2025; Patel & Mehta, 2024). Through this approach, model will be able to predict customer’s product preference with high accuracy but also segment customer into different clusters for better service and effective marketing strategy.  

**Kaggle Dataset:** https://www.kaggle.com/datasets/vishakhdapat/customer-segmentation-clustering

